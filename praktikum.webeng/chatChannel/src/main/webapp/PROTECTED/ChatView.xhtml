<!DOCTYPE html>
<html 
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:jsf="http://xmlns.jcp.org/jsf"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:b="http://bootsfaces.net/ui"
    xmlns:h="http://xmlns.jcp.org/jsf/html">
    
<h:head>
  <title>#{channelBean.channel.channelName}</title>
</h:head>
      <div style = "">
         <ui:insert name = "header">
            <ui:include src = "/templates/header.xhtml" />
         </ui:insert> 
      </div>
      <br/>
     <p>Hey,<h:outputText value="#{userBean.user.username}" />, <BR />
     du befindest Dich gerade im Channel <h:outputText value="#{channelBean.channel.channelName}" /> </p>
    
    
    <p>Aktive Freunde : </p>
    <f:ajax event="change" render="ActiveUserTable" listener="#{channelBean.joinChannel(channelBean.channel, userBean.user)}">
	    <h:dataTable  id="ActiveUserTable" value="#{channelBean.channel.activeuserList}" var="user">
	        <h:column>
	            <h:outputText value="#{user.username}"/>
	        </h:column>
	        <h:column>
	            <h:graphicImage value = "/userPictures/#{user.profilePic}"/>
	        </h:column>
	    </h:dataTable>
    </f:ajax>
    <BR />
    <BR />
    <BR />
    <BR />
    <p>Nachrichten in diesem Channel : </p>
    <h:dataTable  id="MessageTable" value="#{channelBean.channel.messageList}" var="messages">
        <h:column>
            <h:outputText value="#{messages.messageUsername}" style="color : #{userBean.getColorOfUser(messages.messageUsername)}"/> 
        </h:column>
        <h:column>
            <h:outputText value="#{messages.value}" style="color : #{userBean.getColorOfUser(messages.messageUsername)}"/>
        </h:column>
    </h:dataTable>
    

	    <h:form id="loginform">
		  	<h:panelGrid id="grid" columns="3">
		    <h:inputText id="message" value="#{channelBean.valueOfMessage}" required="true"/>
		    	<h:commandButton value="Senden" action="#{channelBean.sendMessage(userBean.user)}"/>
		  	</h:panelGrid>
	 	</h:form>
	 	
	 	<h:form id="refreshform">
	 		<h:panelGrid id="refreshGrid">
		    <h:inputText id="refreshInput" value="#{channelBean.valueOfMessage}" required="true"/>
		    	<h:commandButton value="Senden" action="#{channelBean.sendMessage(userBean.user)}"/>
		  	</h:panelGrid>
	 	</h:form>
	 	
	 	
    
     <h:form id="LeaveChannelForm">
		<h:panelGrid id="grid" columns="3">
   			<h:commandButton value="Channel verlassen" action="#{channelBean.leaveChannel(userBean.user)}" />
		</h:panelGrid>
	 </h:form>
    
    
    
    
    
      <div style = "">
         <ui:insert name = "footer" >
            <ui:include src = "/templates/footer.xhtml" />
         </ui:insert>
      </div>
</html>